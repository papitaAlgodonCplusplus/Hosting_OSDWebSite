"use strict";(self.webpackChunkosdcwebapp=self.webpackChunkosdcwebapp||[]).push([[72],{8615:(m,M,o)=>{o.d(M,{Z:()=>S});var r=o(7394),E=o(9589),a=o(102),e=o(3352),p=o(5879),n=o(4221),c=o(5333),_=o(9707),g=o(9325),d=o(6402),v=o(6896);let S=(()=>{var l;class h{constructor(s,i,t,u,y,A){this.store=s,this.websocketService=i,this.securityDataService=t,this.eventFactoryService=u,this.authenticationService=y,this.notificationService=A,this.securityEventSubscriber=new r.w0,this.subscribeToSecurityEvents()}subscribeToSecurityEvents(){console.log("subscribeToSecurityEvents"),this.securityEventSubscriber=this.websocketService.securityEventHandler.subscribe(s=>this.processSecurityEvent(s))}userLogin(s){const i=this.eventFactoryService.CreateUserLoginEvent(s);this.websocketService.sendSecurityEvent(i)}userRegister(s){const i=this.eventFactoryService.CreateRegisterUserEvent(s);this.websocketService.sendSecurityEvent(i)}verifyEmail(s){const i=this.eventFactoryService.CreateVerifyEmailEvent(s);this.websocketService.sendSecurityEvent(i)}resendEmailVerificationCode(s){const i=this.eventFactoryService.CreateEmailVerificationCodeResendEvent(s);this.websocketService.sendSecurityEvent(i)}processSecurityEvent(s){switch(s.Action){case E.A.HANDLE_CONNECTION_INITIALIZED:this.HandleConnectionInitialized(s);break;case E.A.HANDLE_AUTHENTICATION_RESPONSE:this.HandleAuthenticationResponse(s);break;case E.A.HANDLE_REGISTER_USER_RESPONSE:this.HandleRegisterUserResponse(s);break;case E.A.HANDLE_VERIFY_EMAIL_RESPONSE:this.HandleVerifyEmailResponse(s);break;case E.A.HANDLE_RESEND_EMAIL_VERIFICATION_CODE_RESPONSE:this.HandleResendEmailVerificationCodeResponse(s);break;case E.A.NOTIFY_SESSION_TERMINATED:this.NotifySessionExpired(s);break;case E.A.HANDLE_PASSWORD_RESET_EMAIL_RESPONSE:this.HandlePasswordResetEmailResponse(s);break;case E.A.HANDLE_UPDATE_ACCOUNT_PASSWORD_RESPONSE:this.HandleUpdatePasswordResponse(s)}}HandleConnectionInitialized(s){let i;try{i=s.SessionKey,this.authenticationService.initialize(i)}catch{}}HandleAuthenticationResponse(s){let i,t,u;try{i=JSON.parse(s.getBodyProperty(a.G.USER_AUTHENTICATION_SUCCESS)),t=s.getBodyProperty(a.G.USER_AUTHENTICATION_RESULT_MESSAGE),i?(u=s.getBodyProperty(a.G.GENERATED_SESSION_KEY),this.authenticationService.startSession(u),"Need to verify email"==t?(this.securityDataService.emitUserAuthenticationSuccess("/auth/verify-email"),this.store.dispatch(e.nK.addAlertMessage({alertMessage:"Es necesario verificar su correo electr\xf3nico."})),this.store.dispatch(e.nK.changeAlertType({alertType:"warning"})),this.store.dispatch(e.nK.openAlert())):this.securityDataService.emitUserAuthenticationSuccess("/home"),this.store.dispatch(e.KN.signIn())):(this.store.dispatch(e.nK.addErrorMessage("Credentials are invalid"==t?{errorMessage:"Las credenciales son inv\xe1lidas"}:"The account is still locked due to password errors when logging in. Please try again later."==t?{errorMessage:"La cuenta a\xfan est\xe1 bloqueada debido a errores de contrase\xf1a al iniciar sesi\xf3n. Por favor, int\xe9ntalo de nuevo m\xe1s tarde"}:"Account is locked for 3 minutes. Try again later."==t?{errorMessage:"La cuenta est\xe1 bloqueada durante 3 minutos. Int\xe9ntalo de nuevo m\xe1s tarde"}:{errorMessage:t})),this.store.dispatch(e.nK.toggleErrorModal()))}catch{}}HandleRegisterUserResponse(s){let i,t,u;try{i=JSON.parse(s.getBodyProperty(a.G.REGISTER_USER_SUCCESS)),t=s.getBodyProperty(a.G.REGISTER_USER_RESULT_MESSAGE),this.securityDataService.emitActionRegisterSuccess(i),i?(u=s.getBodyProperty(a.G.GENERATED_SESSION_KEY),this.authenticationService.startSession(u),this.store.dispatch(e.KN.signIn()),this.store.dispatch(e.nK.addAlertMessage("Your account has been created."==t?{alertMessage:"Tu cuenta ha sido creada."}:{alertMessage:t})),this.store.dispatch(e.nK.openAlert())):(this.store.dispatch(e.nK.addErrorMessage("An account already exists with that email."==t?{errorMessage:"Ya existe una cuenta con ese correo electr\xf3nico."}:{errorMessage:t})),this.store.dispatch(e.nK.toggleErrorModal()))}catch{}}HandleVerifyEmailResponse(s){let i,t;try{i=JSON.parse(s.getBodyProperty(a.G.VERIFY_EMAIL_SUCCESS)),t=s.getBodyProperty(a.G.VERIFY_EMAIL_RESULT_MESSAGE),this.securityDataService.emitActionVerifyEmailSuccess(i),i?(this.store.dispatch(e.nK.addAlertMessage("Your email has been verified."==t?{alertMessage:"Su correo electr\xf3nico ha sido verificado."}:{alertMessage:t})),this.store.dispatch(e.nK.openAlert())):(this.store.dispatch(e.nK.addErrorMessage("This code has already expired."==t?{errorMessage:"No se pudo enviar el correo electr\xf3nico."}:"The code is incorrect."==t?{errorMessage:"El c\xf3digo es incorrecto."}:"You will have to wait 10 minutes to enter a new code again."==t?{errorMessage:"Tendr\xe1s que esperar 10 minutos para volver a introducir un nuevo c\xf3digo."}:{errorMessage:t})),this.store.dispatch(e.nK.toggleErrorModal()))}catch{}}HandleResendEmailVerificationCodeResponse(s){let i,t;try{i=JSON.parse(s.getBodyProperty(a.G.EMAIL_VERIFICATION_CODE_SUCCESS)),t=s.getBodyProperty(a.G.EMAIL_VERIFICATION_CODE_RESULT_MESSAGE),i?(this.store.dispatch(e.KN.signIn()),this.store.dispatch(e.nK.addAlertMessage("A new code has been forwarded to your email"==t?{alertMessage:"Se ha enviado un nuevo c\xf3digo a su correo electr\xf3nico."}:{alertMessage:t})),this.store.dispatch(e.nK.openAlert())):"Your email is already verified"==t?(this.store.dispatch(e.nK.changeAlertType({alertType:"warning"})),this.store.dispatch(e.nK.addAlertMessage({alertMessage:"Tu correo electr\xf3nico ya est\xe1 verificado."})),this.store.dispatch(e.nK.openAlert())):"The email could not be sent"==t?(this.store.dispatch(e.nK.addErrorMessage({errorMessage:"No se pudo enviar el correo electr\xf3nico."})),this.store.dispatch(e.nK.toggleErrorModal())):"You will have to wait 10 minutes to generate a new code again."==t?(this.store.dispatch(e.nK.addErrorMessage({errorMessage:"Tendr\xe1s que esperar 10 minutos para generar un nuevo c\xf3digo."})),this.store.dispatch(e.nK.toggleErrorModal())):(this.store.dispatch(e.nK.addErrorMessage({errorMessage:t})),this.store.dispatch(e.nK.toggleErrorModal()))}catch{}}NotifySessionExpired(s){let i,t;try{i=s.getBodyProperty(a.G.RELATED_SESSION_KEY),t=s.getBodyProperty(a.G.SESSIONLESS_KEY),i==this.authenticationService.sessionKey&&(this.authenticationService.endSession(t),this.notificationService.showNotificationToastr(a.G.SESSION_EXPIRED,a.G.INFORMATION))}catch{}}HandlePasswordResetEmailResponse(s){let i,t;try{i=JSON.parse(s.getBodyProperty(a.G.MAIL_SUCCESS_RESET_TOKEN)),t=s.getBodyProperty(a.G.MAIL_MESSAGE_RESET_TOKEN),i?"Check your email, the mail was sent"==t&&(this.store.dispatch(e.nK.addAlertMessage({alertMessage:"Revisa tu correo electr\xf3nico, el correo fue enviado"})),this.store.dispatch(e.nK.openAlert())):"There is no user with that email"==t&&(this.store.dispatch(e.nK.addErrorMessage({errorMessage:"No existe un usuario con ese correo electr\xf3nico"})),this.store.dispatch(e.nK.toggleErrorModal()))}catch{}}HandleUpdatePasswordResponse(s){let i,t;try{i=JSON.parse(s.getBodyProperty(a.G.UPDATE_PASSWORD_SUCCESS)),t=s.getBodyProperty(a.G.UPDATE_PASSWORD_MESSAGES),i?"Your password has been successfully updated"==t&&(this.store.dispatch(e.nK.addAlertMessage({alertMessage:"Su contrase\xf1a se ha actualizado correctamente"})),this.store.dispatch(e.nK.openAlert())):"The link expired, remember that you have 30 minutes to use it"==t?(this.store.dispatch(e.nK.addErrorMessage({errorMessage:"El link expiro, recuerda que tienes 30 minutos para realizar el cambio de contrase\xf1a"})),this.store.dispatch(e.nK.toggleErrorModal())):"The link has already been used"==t?(this.store.dispatch(e.nK.addErrorMessage({errorMessage:"El link ya fue usado"})),this.store.dispatch(e.nK.toggleErrorModal())):"The link is incorrect"==t&&(this.store.dispatch(e.nK.addErrorMessage({errorMessage:"El link es incorrecto"})),this.store.dispatch(e.nK.toggleErrorModal()))}catch{}}}return(l=h).\u0275fac=function(s){return new(s||l)(p.LFG(n.yh),p.LFG(c.i),p.LFG(_.F),p.LFG(g.Q),p.LFG(d.$),p.LFG(v.g))},l.\u0275prov=p.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),h})()},3652:(m,M,o)=>{o.d(M,{k:()=>E});var r=o(5879);let E=(()=>{var a;class e{constructor(){this.emailPattern=/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/i,this.isValidEmail=function(n){const c=n.value.trim();return this.emailPattern.test(c)?null:{invalidEmail:!0}}.bind(this),this.isValidPassword=function(n){const c=n.value,_=/[A-Z]/.test(c),g=/[a-z]/.test(c),d=/\d/.test(c);return _&&g&&d?null:{invalidPassword:!0}}.bind(this),this.confirmPasswordValidator=n=>{const c=n.parent?.get("password")?.value;return c!==n.value?{passwordsDoNotMatch:!0}:null}}isValidField(n,c){return n.controls[c].errors&&n.controls[c].touched}getFieldError(n,c){if("confirmPassword"===c){const g=n.get("confirmPassword");if(g&&g.hasError("passwordsDoNotMatch"))return"Las contrase\xf1as no coinciden"}if(!n.controls[c])return null;const _=n.controls[c].errors||{};for(const g of Object.keys(_))switch(g){case"required":return"Este campo es obligatorio";case"minlength":return`M\xednimo ${_.minlength.requiredLength} caracteres`;case"invalidEmail":return"El correo electr\xf3nico no es v\xe1lido.";case"invalidPassword":return"Su contrase\xf1a es d\xe9bil"}return null}}return(a=e).\u0275fac=function(n){return new(n||a)},a.\u0275prov=r.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),e})()},5347:(m,M,o)=>{o.d(M,{q:()=>g});var r=o(5879),E=o(3652),a=o(6814),e=o(95);function p(d,v){if(1&d&&(r.TgZ(0,"p",5),r._uU(1),r.qZA()),2&d){const S=r.oxw();r.xp6(1),r.hij(" ",S.getFieldError(S.fieldName)," ")}}function n(d,v){1&d&&(r.TgZ(0,"p",6),r._uU(1,"\xa0"),r.qZA())}const _=function(d){return[d,"placeholder:text-darkgray bg-gray-100 text-black block border-solid border w-full p-2  pr-3 rounded-md shadow-sm focus:outline-none focus:border-blue-950"]};let g=(()=>{var d;class v{constructor(l){this.validationsService=l,this.inputType="text",this.bgColor="bg-white",this.blurEvent=new r.vpe}isValidField(l){return this.validationsService.isValidField(this.formGroup,l)}getFieldError(l){return this.validationsService.getFieldError(this.formGroup,l)}}return(d=v).\u0275fac=function(l){return new(l||d)(r.Y36(E.k))},d.\u0275cmp=r.Xpm({type:d,selectors:[["shared-input-field"]],inputs:{fieldName:"fieldName",label:"label",inputType:"inputType",formGroup:"formGroup",bgColor:"bgColor",readOnly:"readOnly"},outputs:{blurEvent:"blurEvent"},decls:8,vars:12,consts:[[1,"relative","w-full","my-1","p-1",3,"formGroup"],["for",""],[3,"ngClass","formControlName","name","id","type","readOnly","blur"],["class","mt-2 text-sm text-red-700",4,"ngIf","ngIfElse"],["hidden",""],[1,"mt-2","text-sm","text-red-700"],[1,"text-sm"]],template:function(l,h){if(1&l&&(r.TgZ(0,"div",0)(1,"div")(2,"label",1),r._uU(3),r.qZA()(),r.TgZ(4,"input",2),r.NdJ("blur",function(){return h.blurEvent.emit()}),r.qZA(),r.YNc(5,p,2,1,"p",3),r.YNc(6,n,2,0,"ng-template",null,4,r.W1O),r.qZA()),2&l){const f=r.MAs(7);r.Q6J("formGroup",h.formGroup),r.xp6(3),r.Oqu(h.label),r.xp6(1),r.Q6J("ngClass",r.VKq(10,_,h.bgColor))("formControlName",h.fieldName)("name",h.fieldName)("id",h.fieldName)("type",h.inputType)("readOnly",h.readOnly),r.xp6(1),r.Q6J("ngIf",h.isValidField(h.fieldName))("ngIfElse",f)}},dependencies:[a.mk,a.O5,e.Fj,e.JJ,e.JL,e.sg,e.u]}),v})()}}]);